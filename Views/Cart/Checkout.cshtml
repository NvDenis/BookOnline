
<div class="container py-5">
    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-danger">
            @TempData["ErrorMessage"]
        </div>
    }
    <h2 class="text-center">Xác nhận đơn hàng</h2>

    <form asp-action="CheckoutPost" method="post">
        @Html.AntiForgeryToken()

        <div class="row">
            <div class="col-md-8">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Sách</th>
                            <th>Giá</th>
                            <th>Số lượng</th>
                            <th>Thành tiền</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{
                            var cart = Context.Session.GetString("cart");
                            var items = Newtonsoft.Json.JsonConvert.DeserializeObject<List<bookstore.Models.CartItem>>(cart ?? "[]");
                            decimal total = 0;
                            foreach (var item in items)
                            {
                                var subTotal = item.Price * item.Quantity;
                                total += subTotal;
                                <tr>
                                    <td>@item.Name</td>
                                    <td>@item.Price.ToString("N0") ₫</td>
                                    <td>@item.Quantity</td>
                                    <td>@subTotal.ToString("N0") ₫</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
                <h4 style="color: red">Tổng cộng: @total.ToString("N0") ₫</h4>
            </div>

            <div class="col-md-4">
                <h5>Thông tin giao hàng</h5>
                <div class="mb-3">
                    <label class="form-label">Tên người nhận</label>
                    <input name="name" class="form-control" />
                </div>
                <div class="mb-3">
                    <label class="form-label">Địa chỉ</label>
                    <textarea name="address" class="form-control"></textarea>
                </div>

                <button type="submit" class="btn btn-success w-100">Đặt hàng</button>
            </div>

            <h5>Phương thức thanh toán</h5>
            <div class="mb-3">
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="paymentMethod" id="cod" value="COD" checked>
                    <label class="form-check-label" for="cod">Thanh toán khi nhận hàng</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="paymentMethod" id="vnpay" value="VNPAY">
                    <label class="form-check-label" for="vnpay">Thanh toán qua VNPAY</label>
                </div>
            </div>

            
        </div>
    </form>
</div>
